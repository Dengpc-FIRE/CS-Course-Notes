# 指令系统

- 关于指令的一些总结

> 指令（又称机器指令）是指示计算机执行某种操作的命令，是计算机运行的最小功能单位。
> 一台计算机的所有指令的集合构成该机的指令系统/指令集。
> 指令系统是计算机的主要属性，位于硬件和软件的交界面上。也可以说指令系统是计算机硬/软件的界面。
> 指令系统是计算机硬件的语言系统，和机器语言有关。
> 指令的地址数和指令的长度是否固定没有一定的关系。
> 指令长度与机器字长没有一定的关系。
> 因为主存一般是按字节编址的，所以指令字长多为字节的整数倍。为了便于取指，指令长度也可能是存储字长的整数倍。
>
> - 微指令：是微程序级的命令，它属于硬件；
> - 宏指令：由若干条机器指令组成的软件指令，它属于软件；
> - 机器指令：介于微指令与宏指令之间，通常简称为指令，每一条指令可完成一个独立的算术运算或逻辑运算等操作。

## 7.1 机器指令

### 7.1.1指令格式

![img](https://pic3.zhimg.com/80/v2-6ca955a861f6d76bca2c91e463776332_720w.webp)

**操作码**：指出指令中该指令应该执行什么性质的操作和具有何种功能。（有等长和变长之分）

**地址码**：给出被操作的信息（指令或数据）的地址。

四次访存：取指令，取两个操作数，保存结果

**扩展操作码技术**

![image-20230424175810639](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424175810639.png)

**（1）四地址**

![image-20230424173953904](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424173953904.png)

现在一般用PC代替下一指令地址，PC代替A4

**（2）三地址**

![image-20230424174136609](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424174136609.png)

若A3用A1或A2代替

**（3）二地址**

![image-20230424174457946](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424174457946.png)

**（4）一地址**

![image-20230424174649982](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424174649982.png)

**（5）零地址**

堆栈等操作

### 7.1.2 指令字长

![image-20230424174834807](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424174834807.png)

![image-20230424174955830](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424174955830.png)

小结

![image-20230424175322523](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424175322523.png)



## 7.2 操作数的类型和操作种类

### 7.2.1 操作数类型

**1.操作数类型**

地址：无符号整数

数字：定点数、浮点数、十进制数

字符：ASCII

逻辑数：逻辑运算

**2.数据在存储器中的存放方式**

**3.移位操作**

![image-20230424220852394](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424220852394.png)

**4.转移**

![image-20230424220840290](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230424220840290.png)

**5.输入输出**

![image-20230425191429561](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425191429561.png)

## 7.3寻址方式

确定本条指令的操作数地址

下一条要执行指令的指令地址

![image-20230425193759016](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425193759016.png)

## ![image-20230425191653019](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425191653019.png)

### 7.3.1 指令寻址

![image-20230425192134663](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425192134663.png)

### 7.3.2 数据寻址

**1.立即寻址**

![image-20230425192742038](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425192742038.png)

指令执行阶段不访存

A的位数限制了立即数的范围

> 寻址特征为“#”，表示是立即数寻址，形式地址放的就是操作数，执行时无需访存，立即数以补码的形式表示，A的位数限制了立即数的大小。

**2.直接寻址**

EA=A 有效地址由形式地址直接给出

![image-20230425193118444](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425193118444.png)

**3.隐含寻址**

![image-20230425193448927](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425193448927.png)

**4.间接寻址**

![image-20230425195300943](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425195300943.png)



**地址码部分存储的地址分为有效地址和形式地址，之前讲的直接寻址和隐含寻址，地址码部分存储的A（即形式地址）==EA（即有效地址），所以地址码即是数据的地址，可以通过地址码直接找到数据的存储位置，间接寻址中地址码存储的A不等同于EA，A是EA的地址，EA才是数据的地址。和之前的中断向量相似。**



**5.寄存器寻址**

![image-20230425200045045](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425200045045.png)

**6.寄存器间接寻址**

![image-20230425200254442](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425200254442.png)

**7.基址寻址**

![image-20230425200540120](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425200540120.png)

![image-20230425200715288](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425200715288.png)

**8.变址寻址**

![image-20230425200930529](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425200930529.png)

**9.相对寻址**

![image-20230425201407361](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425201407361.png)

按字节

![image-20230425201721961](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425201721961.png)

**10.堆栈寻址**

![image-20230425202042764](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425202042764.png)

![image-20230425202322228](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425202322228.png)

## 7.4 指令格式的距离

### 7.4.1 设计指令时考虑的各种因素

![image-20230425202714711](C:\Users\邓\AppData\Roaming\Typora\typora-user-images\image-20230425202714711.png)

## 7.5 RISC技术

CISC复杂指令系统计算机，功能更强大，指令更复杂；RISC精简指令系统计算机，指令简单，执行速度快。



![img](https://pic3.zhimg.com/80/v2-1ca4971f90c45c9e5552102e32349276_720w.webp)



RISC精简指令系统计算机，要求指令系统简化，尽量使用**寄存器-寄存器**操作指令。指令格式一致，指令长度固定、种类少，寻址方式种类少，**指令功能没那么强**。

RISC采用指令流水线技术，使大部分指令在一个时钟周期内完成。适合流水线的指令系统的特征有∶ ①指令长度应尽量一致;② 指令格式应尽量规整;③ 保证除Load/Store指令外的其他指令都不访问存储器; ④数据和指令在存储器中"对齐"存放。

三大最大特点：

- 选取使用频率最高的一些简单指令，指令条数少；
- 指令长度固定，指令格式种类少，寻址方式种类少；
- 只有取数/存数两条指令访问存储器，其余指令的操作都在寄存器中进行。

## 王道选择题笔记

**1.程序控制类的指令**
功能是改变程序执行的顺序，包括：无条件转移、有条件转移、子程序调用、返回指令、循环指令。

**2.某计算机按字节编址，指令字长固定且只有两种指令格式，其中三地址指令29条、二地址指令107条，每个地址字段为6位，则指令字长至少应该是（24位）。**
计算出来是23，但由于按字节编址，所以应当是8的倍数，取24。

**3.运算型指令的寻址和转移性指令的寻址不同点在于**：
前者取操作数，后者决定程序转移地址。

**4.某指令系统有200条指令，对操作码采用固定长度二进制编码，最少需要用(8)位。**

**5.一个计算机系统采用32位单字长指令，地址码为12位，若定义了250条二地址指令，则还可以有（24K）条单地址指令。**
地址码为12位，二地址指令的操作码长度为32-12-12=8位，已定义了250条二地址指令，28-250=6，即可以设计出单地址指令6×212=24K条。